function dumpCapital(obj,timetype,filetype,filename,varargin)
    if nargin == 2
        filetype = 'stdio';
    end
    %
    if timetype == EnumType.NOW
        capiBox = struct('time',now,'capital',obj.m_Capital);
        defFileStr = 'CapitalInfo';
    elseif timetype == EnumType.DAY
        capiBox = obj.m_CapiDayBox;
        defFileStr = 'DailyCapiInfo';
    elseif timetype == EnumType.HOUR
        capiBox = obj.m_CapiHourBox;
        defFileStr = 'HourCapiInfo';
    else
        obj.m_Log.printFatal('Error! dumpCapital() can not support timetype %s.',char(timetype));
        return;
    end
    %
    if filetype == EnumType.XLSX
        if nargin >= 4
            pathname = filename;
        else
            pathname = strcat(defFileStr,'.xlsx');
        end
        %
        if (exist(pathname,'file') == 2)
            [~,~,R] = xlsread(pathname);
            startIdx = size(R,1) + 1;
        else
            startIdx = 1;
        end
        %
        if timetype == EnumType.NOW
            x = cell(length(capiBox)+1,11);
            x(1,:) = {'DateTime','Deposit','Settle','Balance', ...
                      'Margin','CloseGain','FloatGain','FreeMoney', ...
                      'Fee','Profit','Yield(%)'};
        else
            x = cell(length(capiBox)+1,12);
            x(1,:) = {'No.','DateTime','Deposit','Settle','Balance', ...
                      'Margin','CloseGain','FloatGain','FreeMoney', ...
                      'Fee','Profit','Yield(%)'};
        end
        %
        for i = 1:length(capiBox)
            profit = capiBox(i).capital.balance - capiBox(i).capital.deposit;
            if capiBox(i).capital.deposit > 0
                yield = double(profit)/capiBox(i).capital.deposit;
            else
                yield = 0;
            end
            if timetype == EnumType.NOW
                x(i+1,:) = {
                                datestr(capiBox(i).time), ...
                                capiBox(i).capital.deposit, ...
                                capiBox(i).capital.settle, ...
                                capiBox(i).capital.balance, ...
                                abs(capiBox(i).capital.margin), ...
                                capiBox(i).capital.closePosiGain, ...
                                capiBox(i).capital.openPosiGain, ...
                                capiBox(i).capital.freeMoney, ...
                                capiBox(i).capital.fee, ...
                                profit, ...
                                yield*100
                           };
            else
                x(i+1,:) = {
                                i, ...
                                datestr(capiBox(i).time), ...
                                capiBox(i).capital.deposit, ...
                                capiBox(i).capital.settle, ...
                                capiBox(i).capital.balance, ...
                                abs(capiBox(i).capital.margin), ...
                                capiBox(i).capital.closePosiGain, ...
                                capiBox(i).capital.openPosiGain, ...
                                capiBox(i).capital.freeMoney, ...
                                capiBox(i).capital.fee, ...
                                profit, ...
                                yield*100
                           };
            end
        end
        obj.m_Log.printInfo('Dump capital account into %s ......',pathname);
        xlswrite(pathname,x,1,num2str(startIdx));
    elseif filetype == EnumType.TXT 
        if nargin >= 4
            pathname = filename;
        else
            pathname = strcat(defFileStr,'.txt');
        end
        %
        obj.m_Log.printInfo('Dump capital account into %s ......',pathname);
        fid = fopen(pathname,'a');
        fprintf(fid,'----------------------------------------------------------------------------------------------------------------------------------------\r\n');
        fprintf(fid,'----------------------------------------------------Capital Infomation------------------------------------------------------------------\r\n');
        fprintf(fid,'----------------------------------------------------------------------------------------------------------------------------------------\r\n');
        if timetype == EnumType.NOW
            fprintf(fid,'%-20s %12s %12s %12s %10s %10s %10s %12s %8s %12s %8s\r\n', ...
                        'DateTime','Deposit','Settle','Balance','Margin', ...
                        'CloseGain','FloatGain','FreeMoney','Fee','Profit','Yield(%)');
        else
            fprintf(fid,'%-5s %-20s %12s %12s %12s %10s %10s %10s %12s %8s %12s %8s\r\n', ...
                        'No.','DateTime','Deposit','Settle','Balance','Margin', ...
                        'CloseGain','FloatGain','FreeMoney','Fee','Profit','Yield(%)');
        end
        for i=1:length(capiBox)
            profit = capiBox(i).capital.balance - capiBox(i).capital.deposit;
            if capiBox(i).capital.deposit > 0
                yield = double(profit)/capiBox(i).capital.deposit;
            else
                yield = 0;
            end
            if timetype == EnumType.NOW
                fprintf(fid,'%-20s %12.2f %12.2f %12.2f %10.2f %10.2f %10.2f %12.2f %8.2f %12.2f %7.2f%%\r\n', ...
                        datestr(capiBox(i).time), ...
                        capiBox(i).capital.deposit, ...
                        capiBox(i).capital.settle, ...
                        capiBox(i).capital.balance, ...
                        abs(capiBox(i).capital.margin), ...
                        capiBox(i).capital.closePosiGain, ...
                        capiBox(i).capital.openPosiGain, ...
                        capiBox(i).capital.freeMoney, ...
                        capiBox(i).capital.fee, ...
                        profit, ...
                        yield*100);
            else
                fprintf(fid,'%-5d %-20s %12.2f %12.2f %12.2f %10.2f %10.2f %10.2f %12.2f %8.2f %12.2f %7.2f%%\r\n', ...
                        i, ...
                        datestr(capiBox(i).time), ...
                        capiBox(i).capital.deposit, ...
                        capiBox(i).capital.settle, ...
                        capiBox(i).capital.balance, ...
                        abs(capiBox(i).capital.margin), ...
                        capiBox(i).capital.closePosiGain, ...
                        capiBox(i).capital.openPosiGain, ...
                        capiBox(i).capital.freeMoney, ...
                        capiBox(i).capital.fee, ...
                        profit, ...
                        yield*100);
            end
        end
        fclose(fid);
    elseif filetype == EnumType.STDIO
        obj.m_Log.printInfo('----------------------------------------------------------------------------------------------------------------------------------------');
        obj.m_Log.printInfo('----------------------------------------------------Capital Infomation------------------------------------------------------------------');
        obj.m_Log.printInfo('----------------------------------------------------------------------------------------------------------------------------------------');
        if timetype == EnumType.NOW
            obj.m_Log.printInfo('%-20s %12s %12s %12s %10s %10s %10s %12s %8s %12s %8s', ...
                                'DateTime','Deposit','Settle','Balance','Margin', ...
                                'CloseGain','FloatGain','FreeMoney','Fee','Profit','Yield(%)');
        else
            obj.m_Log.printInfo('%-5s %-20s %12s %12s %12s %10s %10s %10s %12s %8s %12s %8s', ...
                                'No.','DateTime','Deposit','Settle','Balance','Margin', ...
                                'CloseGain','FloatGain','FreeMoney','Fee','Profit','Yield(%)');
        end
        for i=1:length(capiBox)
            profit = capiBox(i).capital.balance - capiBox(i).capital.deposit;
            if capiBox(i).capital.deposit > 0
                yield = double(profit)/capiBox(i).capital.deposit;
            else
                yield = 0;
            end
            if timetype == EnumType.NOW
                obj.m_Log.printInfo('%-20s %12.2f %12.2f %12.2f %10.2f %10.2f %10.2f %12.2f %8.2f %12.2f %7.2f%%', ...
                                    datestr(capiBox(i).time), ...
                                    capiBox(i).capital.deposit, ...
                                    capiBox(i).capital.settle, ...
                                    capiBox(i).capital.balance, ...
                                    abs(capiBox(i).capital.margin), ...
                                    capiBox(i).capital.closePosiGain, ...
                                    capiBox(i).capital.openPosiGain, ...
                                    capiBox(i).capital.freeMoney, ...
                                    capiBox(i).capital.fee, ...
                                    profit, ...
                                    yield*100);
            else
                obj.m_Log.printInfo('%-5d %-20s %12.2f %12.2f %12.2f %10.2f %10.2f %10.2f %12.2f %8.2f %12.2f %7.2f%%', ...
                                    i, ...
                                    datestr(capiBox(i).time), ...
                                    capiBox(i).capital.deposit, ...
                                    capiBox(i).capital.settle, ...
                                    capiBox(i).capital.balance, ...
                                    abs(capiBox(i).capital.margin), ...
                                    capiBox(i).capital.closePosiGain, ...
                                    capiBox(i).capital.openPosiGain, ...
                                    capiBox(i).capital.freeMoney, ...
                                    capiBox(i).capital.fee, ...
                                    profit, ...
                                    yield*100);
            end
        end
    elseif filetype == EnumType.DATABASE
        % dump capital info into database
    else
        obj.m_Log.printFatal('dumpCapital() parameter is error!');
    end
end